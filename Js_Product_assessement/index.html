<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" href="../Bootstrap/assets/css/bootstrap.min.css">
  <script src="https://kit.fontawesome.com/d48236184a.js" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="style.css">

  <title>Add Product</title>
</head>

<body>

  <section>
    <div class="container">
      <div class="row m-1 ">
        <div class="col-lg-3"></div>
        <div class="col-lg-6 center div-border p-lg-5 p-0 mb-5" id="addProduct">
          <div class="product-box">
            <form action="" class="mx-4">
              <h2 class="text-center mb-lg-5 m-4 product-title">Add Product</h2>
              <div class="row">
                <div class="col-12">
                  <div class="form-group form-inline">
                    <label for="" class="mr-3">Product Title <span class="mx-1" style="color:red;"
                        id="firstStar">*</span> : </label>
                    <input type="text"  placeholder="Enter the Product Title" class="form-control prod-title" id="prodTitle" onkeyup="validateTitle()">
                    <span id="prodTitleError" style="display: none;">* Product title cannont be empty</span>
                  </div>
                  <div class="form-group form-inline">
                    <label for="" class="mr-3">Description <span class="mx-1" style="color:red;"
                      id="firstStar">*</span> : </label>
                    <textarea name="" cols="30"  placeholder="Enter the product Description" rows="4" class="form-control" id="prodDesc"
                      onkeyup="validateDesc()"></textarea>
                    <span id="prodDescError" style="display: none;">* Product Description cannont be empty</span>

                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-6">
                  <div class="form-group">
                    <label for="">Price <span class="mx-1" style="color:red;"
                      id="firstStar">*</span>:</label>
                    <input type="number"  placeholder="Enter the Price" class="form-control" id="prodPrice" onkeyup="validatePrice()">
                    <span id="prodPriceError" style="display: none;">* Price cannot be Empty</span>
                  </div>

                </div>
                <div class="col-6">
                  <div class="form-group">
                    <label for="">Max Limit <span class="mx-1" style="color:red;"
                      id="firstStar">*</span>:</label>
                    <input type="number"  placeholder="Set Max Limit" class="form-control" id="maxLimit" onkeyup="validateLimit()">
                    <span id="prodLimitError" style="display: none;">* Limit cannot be Empty</span>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-xl-6 col-sm-12 ">
                  <label for="" class="mb-3">Image <span class="mx-1" style="color:red;"
                    id="firstStar">*</span>: </label>
                  <input type="file" id="imgFile" onchange="imgPreview(event)">
                  <span id="prodImageError" style="display: none;">* Image cannot be Empty</span>

                </div>
                <div class="col-xl-6 col-sm-12 text-center mt-xl-0 mt-4 img-div">
                  <img src="./img/no_img.jpg" class="img-fliud preview" id="imgChange" height="100px" width="130px"
                    alt="">
                </div>
              </div>
              <div class="text-center mt-4 mb-xl-0 mb-4" id="submitForValidate">
                <input type="button" class="btn  mx-auto text-center" value="Submit" id="validateSubmit"
                  onclick="validate()">
              </div>
              <div class="text-center mt-4 mb-xl-0 mb-4 d-none" id="prodPage">
                <a href="product.html" id="submiting" target="blank" onclick="validate()"
                  class="btn btn-success mx-auto text-center" id="greenSubmit"
                  style="box-shadow: 0px 0px 9px 0px black;">Submitting...</a>
              </div>
            </form>
          </div>
        </div>



        <!-- <img src="./img/no_img.jpg" class="img-fliud preview" id="imgNew" height="100px" width="130px" alt=""> -->
        <!-- <input type="button" value="submit" class="btn btn-primary" onclick="newImage()"> -->
      </div>
      <div class="col-lg-3"></div>
    </div>
    </div>
  </section>





  <script src="../Bootstrap/assets/js/jquery.slim.min.js"></script>
  <script src="../Bootstrap/assets/js/bootstrap.bundle.min.js"></script>

</body>

</html>
<script>

  var flagprodTitle = 0;
  var flagprodDesc = 0;
  var flagprodPrice = 0;
  var flagmaxLimit = 0;
  var flagImg = 0;


  //---------------------------Title validation-----------------------
  function validateTitle() {
    var prodTitle = document.getElementById('prodTitle').value;
    if (prodTitle) {
      if (prodTitle.length > 2) {
        document.getElementById('prodTitle').style = "border : 2.5px solid green";
        document.getElementById('prodTitleError').style = "display:none;";
        flagprodTitle = 1;
      }
      else {
        document.getElementById('prodTitle').style = "border : 2px solid red";
        document.getElementById('prodTitleError').style = "display:inline-block; margin-left:auto; margin-right:50px; color : red !important; font-size:14px";
        document.getElementById('prodTitleError').innerHTML = "* length should be greater than 2";
        flagprodTitle = 0;
      }

    }
    else {
      document.getElementById('prodTitle').style = "border : 2px solid red";
      document.getElementById('prodTitleError').style = "display:inline-block; margin-left:auto; margin-right:50px; color : red !important; font-size:14px";
      document.getElementById('prodTitleError').innerHTML = "* Product title cannont be empty";
      flagprodTitle = 0;
    }
  }

  //---------------------------------Description Validation---------------

  function validateDesc() {
    let prodDesc = document.getElementById('prodDesc').value;
    if (prodDesc) {
      if (prodDesc.length > 10) {
        document.getElementById('prodDesc').style = "border : 2.5px solid green";
        document.getElementById('prodDescError').style = "display:none;";
        flagprodDesc = 1;
      }
      else {
        document.getElementById('prodDesc').style = "border : 2px solid red";
        document.getElementById('prodDescError').style = "display:inline-block; margin-left:auto; margin-right:60px; color : red !important; font-size:14px";
        flagprodDesc = 0;
        document.getElementById('prodDescError').innerHTML = "* length should be greater than 10";
      }
    }
    else {
      flagprodDesc = 0;
      document.getElementById('prodDesc').style = "border : 2px solid red";
      document.getElementById('prodDescError').style = "display:inline-block; margin-left:auto; margin-right:22px !important; color : red !important; font-size:14px";
      document.getElementById('prodDescError').innerHTML = "* Product Description cannont be empty";
    }
  }

  //------------------------------Price validation----------------

  function validatePrice() {
    let prodPrice = document.getElementById('prodPrice').value;
    if (prodPrice) {
      if (prodPrice > 1) {
        document.getElementById('prodPrice').style = "border : 2.5px solid green";
        document.getElementById('prodPriceError').style = "display:none;";
        flagprodPrice = 1;

      }
      else {
        document.getElementById('prodPrice').style = "border : 2px solid red";
        document.getElementById('prodPriceError').style = "display:inline-block; margin-left:auto;color : red !important; font-size:14px";
        flagprodPrice = 0;
        document.getElementById('prodPriceError').innerHTML = "* Price should be greater than 0";
      }

    }
    else {
      flagprodPrice = 0;
      document.getElementById('prodPrice').style = "border : 2px solid red";
      document.getElementById('prodPriceError').style = "display:inline-block; margin-left:auto; margin-right:22px !important; color : red !important; font-size:14px";
      document.getElementById('prodPriceError').innerHTML = "* Price cannot be Empty";
    }

  }

  //------------------------Limit validation----------------

  function validateLimit() {
    let maxLimit = document.getElementById('maxLimit').value;
    if (maxLimit) {
      if (maxLimit > 1) {
        document.getElementById('maxLimit').style = "border : 2.5px solid green";
        document.getElementById('prodLimitError').style = "display:none;";
        flagmaxLimit = 1;
      }
      else {
        document.getElementById('maxLimit').style = "border : 2px solid red";
        document.getElementById('prodLimitError').style = "display:inline-block; margin-left:auto;color : red !important; font-size:14px";
        flagmaxLimit = 0;
        document.getElementById('prodLimitError').innerHTML = "* Limit should be greater than 0";
      }

    }
    else {
      flagmaxLimit = 0;
      document.getElementById('maxLimit').style = "border : 2px solid red";
      document.getElementById('prodLimitError').style = "display:inline-block; margin-left:auto; margin-right:22px !important; color : red !important; font-size:14px";
      document.getElementById('prodLimitError').innerHTML = "* Limit cannot be Empty";
    }
  }
  //-------------------------img check----------------

  function imgCheck() {
    let imgFile = document.getElementById('imgFile').files[0];
    if (imgFile) {
      if (checkExtension(imgFile)) {

        document.getElementById('imgFile').style = "border : 2.5px solid green; border-radius:10px !important;";
        document.getElementById('prodImageError').style = "display:none;";
        flagImg = 1;

      }
    }
    else {
      flagImg = 0;
      document.getElementById('imgFile').style = "border : 2px solid red;border-radius:10px !important;";
      document.getElementById('prodImageError').style = "display:inline-block; margin-left:auto; margin-right:22px !important; color : red !important; font-size:14px";
      document.getElementById('prodImageError').innerHTML = "* Image cannot be Empty";
    }
  }

  // ----------------Selected img for preview------------------

  function imgPreview(event) {

    var imgFile = event.target.files[0]
    var output = document.getElementById('imgChange');
  
    if (imgFile) {
      document.getElementById('imgFile').style = "border : 2.5px solid green;border-radius:10px !important;";
      document.getElementById('prodImageError').style = "display:none;";
    }
    else {
      document.getElementById('imgFile').style = "border : 2px solid red;border-radius:10px !important;";
      document.getElementById('prodImageError').style = "display:inline-block; margin-left:auto; margin-right:22px !important; color : red !important; font-size:14px";
      document.getElementById('prodImageError').innerHTML = "* Image cannot be Empty";
    }

    if (checkExtension(imgFile)) {
      output.src = URL.createObjectURL(imgFile);
      output.onload = function () {
        URL.revokeObjectURL(output.src)
      }

      const reader = new FileReader();
      reader.onload = function (event) {
        const imageData = event.target.result;
        localStorage.setItem('imageData', imageData);
      };
      reader.readAsDataURL(imgFile);
    }
  }
  //-------------------check Extension-------------------------
  function checkExtension(imgFile) {
    var extension = imgFile.type.split('/')[1].toLowerCase();
    if (extension == 'jpg' || extension == 'png' || extension == 'jpeg') {
      document.getElementById('imgFile').style = "border : 2.5px solid green;border-radius:10px !important;";
      document.getElementById('prodImageError').style = "display:none;";
      return true;
    }
    else {
      document.getElementById('imgFile').style = "border : 2px solid red;border-radius:10px !important;";
      document.getElementById('prodImageError').style = "display:inline-block; margin-left:auto; color : red !important; font-size:14px";
      document.getElementById('prodImageError').innerHTML = "* Image extension should be jpg, png, jpeg";
      return false;
    }

  }
  //--------------------Complete Validate----------------

  function validate() {
    validateTitle();
    validateDesc();
    validatePrice();
    validateLimit();
    imgCheck();

    var sumOfFlag = flagprodTitle + flagprodDesc + flagprodPrice + flagmaxLimit + flagImg;

    if (sumOfFlag == 5) {

      // console.log(prodTitle , prodDesc , prodPrice ,maxLimit);
      document.getElementById('submiting').innerHTML = "Submitting.."
      document.getElementById('submitForValidate').style = "display:none";
      document.getElementById('prodPage').style = "display:block !important";
      localStorage.setItem('productTitle', prodTitle.value)
      localStorage.setItem('productDesc', prodDesc.value)
      localStorage.setItem('productPrice', prodPrice.value)
      localStorage.setItem('productLimit', maxLimit.value)


      window.location.href = "product.html";


      // document.getElementById('addProduct').style = "display:none";
      // document.getElementById('productView').style = "display:block !important";

      // document.getElementById('newProdTitle').innerHTML = localStorage.getItem('productTitle')
      // document.getElementById('newProdDesc').innerHTML = localStorage.getItem('productDesc')

    }
  }

  function plus() {
    let maxLimit = document.getElementById('maxLimit').value;


  }

</script>